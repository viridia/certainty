<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/subject/subject.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="LogStrategy.html">LogStrategy</a><ul class='methods'><li data-type='method'><a href="LogStrategy.html#assertNoErrors">assertNoErrors</a></li><li data-type='method'><a href="LogStrategy.html#fail">fail</a></li></ul></li><li><a href="module-certainty-ArraySubject.html">ArraySubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-ArraySubject.html#contains">contains</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsAll">containsAll</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsAllIn">containsAllIn</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsAllOf">containsAllOf</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsAny">containsAny</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsAnyIn">containsAnyIn</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsAnyOf">containsAnyOf</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsExactly">containsExactly</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsExactlyIn">containsExactlyIn</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsNone">containsNone</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsNoneIn">containsNoneIn</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#containsNoneOf">containsNoneOf</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#doesNotContain">doesNotContain</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#eachElement">eachElement</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#hasLength">hasLength</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-certainty-ArraySubject.html#isNotEmpty">isNotEmpty</a></li></ul></li><li><a href="module-certainty-DeferredSubject.html">DeferredSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-DeferredSubject.html#invoke">invoke</a></li><li data-type='method'><a href="module-certainty-DeferredSubject.html#run">run</a></li></ul></li><li><a href="module-certainty-EachSubject.html">EachSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-EachSubject.html#invoke">invoke</a></li></ul></li><li><a href="module-certainty-EventualSubject.html">EventualSubject</a></li><li><a href="module-certainty-FieldValue.html">FieldValue</a><ul class='methods'><li data-type='method'><a href="module-certainty-FieldValue.html#withValue">withValue</a></li></ul></li><li><a href="module-certainty-InOrder.html">InOrder</a><ul class='methods'><li data-type='method'><a href="module-certainty-InOrder.html#inOrder">inOrder</a></li></ul></li><li><a href="module-certainty-KeyValue.html">KeyValue</a><ul class='methods'><li data-type='method'><a href="module-certainty-KeyValue.html#withValue">withValue</a></li></ul></li><li><a href="module-certainty-MapSubject.html">MapSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-MapSubject.html#containsEntry">containsEntry</a></li><li data-type='method'><a href="module-certainty-MapSubject.html#containsKey">containsKey</a></li><li data-type='method'><a href="module-certainty-MapSubject.html#doesNotContainKey">doesNotContainKey</a></li><li data-type='method'><a href="module-certainty-MapSubject.html#hasSize">hasSize</a></li><li data-type='method'><a href="module-certainty-MapSubject.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-certainty-MapSubject.html#isNotEmpty">isNotEmpty</a></li></ul></li><li><a href="module-certainty-ObjectSubject.html">ObjectSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-ObjectSubject.html#doesNotHaveField">doesNotHaveField</a></li><li data-type='method'><a href="module-certainty-ObjectSubject.html#doesNotHaveOwnField">doesNotHaveOwnField</a></li><li data-type='method'><a href="module-certainty-ObjectSubject.html#hasField">hasField</a></li><li data-type='method'><a href="module-certainty-ObjectSubject.html#hasOwnField">hasOwnField</a></li><li data-type='method'><a href="module-certainty-ObjectSubject.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-certainty-ObjectSubject.html#isNotEmpty">isNotEmpty</a></li></ul></li><li><a href="module-certainty-PromiseSubject.html">PromiseSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-PromiseSubject.html#eventually">eventually</a></li><li data-type='method'><a href="module-certainty-PromiseSubject.html#fails">fails</a></li><li data-type='method'><a href="module-certainty-PromiseSubject.html#failsWith">failsWith</a></li><li data-type='method'><a href="module-certainty-PromiseSubject.html#succeeds">succeeds</a></li><li data-type='method'><a href="module-certainty-PromiseSubject.html#succeedsWith">succeedsWith</a></li></ul></li><li><a href="module-certainty-Registry.html">Registry</a><ul class='methods'><li data-type='method'><a href="module-certainty-Registry.html#addType">addType</a></li><li data-type='method'><a href="module-certainty-Registry.html#getFormatter">getFormatter</a></li></ul></li><li><a href="module-certainty-SetSubject.html">SetSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-SetSubject.html#contains">contains</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsAll">containsAll</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsAllIn">containsAllIn</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsAllOf">containsAllOf</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsAny">containsAny</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsAnyIn">containsAnyIn</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsAnyOf">containsAnyOf</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsExactly">containsExactly</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsExactlyIn">containsExactlyIn</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsNone">containsNone</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsNoneIn">containsNoneIn</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#containsNoneOf">containsNoneOf</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#doesNotContain">doesNotContain</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#eachMember">eachMember</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#hasSize">hasSize</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-certainty-SetSubject.html#isNotEmpty">isNotEmpty</a></li></ul></li><li><a href="module-certainty-StringSubject.html">StringSubject</a><ul class='methods'><li data-type='method'><a href="module-certainty-StringSubject.html#doesNotInclude">doesNotInclude</a></li><li data-type='method'><a href="module-certainty-StringSubject.html#endsWith">endsWith</a></li><li data-type='method'><a href="module-certainty-StringSubject.html#includes">includes</a></li><li data-type='method'><a href="module-certainty-StringSubject.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="module-certainty-StringSubject.html#isNotEmpty">isNotEmpty</a></li><li data-type='method'><a href="module-certainty-StringSubject.html#matches">matches</a></li><li data-type='method'><a href="module-certainty-StringSubject.html#startsWith">startsWith</a></li></ul></li><li><a href="module-certainty-Subject.html">Subject</a><ul class='methods'><li data-type='method'><a href="module-certainty-Subject.html#describe">describe</a></li><li data-type='method'><a href="module-certainty-Subject.html#equals">equals</a></li><li data-type='method'><a href="module-certainty-Subject.html#exists">exists</a></li><li data-type='method'><a href="module-certainty-Subject.html#fail">fail</a></li><li data-type='method'><a href="module-certainty-Subject.html#failComparison">failComparison</a></li><li data-type='method'><a href="module-certainty-Subject.html#failEqual">failEqual</a></li><li data-type='method'><a href="module-certainty-Subject.html#failNotEqual">failNotEqual</a></li><li data-type='method'><a href="module-certainty-Subject.html#hasType">hasType</a></li><li data-type='method'><a href="module-certainty-Subject.html#isDeeplyEqualTo">isDeeplyEqualTo</a></li><li data-type='method'><a href="module-certainty-Subject.html#isEqualTo">isEqualTo</a></li><li data-type='method'><a href="module-certainty-Subject.html#isExactly">isExactly</a></li><li data-type='method'><a href="module-certainty-Subject.html#isFalse">isFalse</a></li><li data-type='method'><a href="module-certainty-Subject.html#isFalsey">isFalsey</a></li><li data-type='method'><a href="module-certainty-Subject.html#isGreaterThan">isGreaterThan</a></li><li data-type='method'><a href="module-certainty-Subject.html#isIn">isIn</a></li><li data-type='method'><a href="module-certainty-Subject.html#isInstanceOf">isInstanceOf</a></li><li data-type='method'><a href="module-certainty-Subject.html#isLessThan">isLessThan</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotDeeplyEqualTo">isNotDeeplyEqualTo</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotEqualTo">isNotEqualTo</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotGreaterThan">isNotGreaterThan</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotInstanceOf">isNotInstanceOf</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotLessThan">isNotLessThan</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotNull">isNotNull</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotNullOrUndefined">isNotNullOrUndefined</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNotUndefined">isNotUndefined</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNull">isNull</a></li><li data-type='method'><a href="module-certainty-Subject.html#isNullOrUndefined">isNullOrUndefined</a></li><li data-type='method'><a href="module-certainty-Subject.html#isTrue">isTrue</a></li><li data-type='method'><a href="module-certainty-Subject.html#isTruthy">isTruthy</a></li><li data-type='method'><a href="module-certainty-Subject.html#isUndefined">isUndefined</a></li><li data-type='method'><a href="module-certainty-Subject.html#named">named</a></li><li data-type='method'><a href="module-certainty-Subject.html#withFailureMessage">withFailureMessage</a></li></ul></li><li><a href="module-certainty-SubjectFactory.html">SubjectFactory</a><ul class='methods'><li data-type='method'><a href="module-certainty-SubjectFactory.html#addType">addType</a></li><li data-type='method'><a href="module-certainty-SubjectFactory.html#newSubject">newSubject</a></li></ul></li><li><a href="ProxyBase.html">ProxyBase</a><ul class='methods'><li data-type='method'><a href="ProxyBase.html#.addMethod">addMethod</a></li><li data-type='method'><a href="ProxyBase.html#.addMethods">addMethods</a></li><li data-type='method'><a href="ProxyBase.html#invoke">invoke</a></li></ul></li><li><a href="ThrowStrategy.html">ThrowStrategy</a><ul class='methods'><li data-type='method'><a href="ThrowStrategy.html#fail">fail</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-certainty.html">certainty</a><ul class='methods'><li data-type='method'><a href="module-certainty.html#~ensure">ensure</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#compare">compare</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#formatArray">formatArray</a></li><li><a href="global.html#formatMap">formatMap</a></li><li><a href="global.html#formatObject">formatObject</a></li><li><a href="global.html#formatPromise">formatPromise</a></li><li><a href="global.html#formatSet">formatSet</a></li><li><a href="global.html#formatString">formatString</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/subject/subject.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module certainty */
var diff = require('../compare').diff;
var compare = require('../compare').compare;
var format = require('../format/format');

/** Represents the value being checked, and provides assertion methods. Can be subclassed to
    provide assertion methods that are type-specific.
    @param {FailureStrategy} failureStrategy The failure strategy to use when an assertion fails.
    @param {*} value The value being checked.
    @constructor
*/
function Subject(failureStrategy, value) {
  this.failureStrategy = failureStrategy;
  this.value = value;
  this.name = null;
  this.format = format;
  this.failureMessage = null;
}

/** Return a string description of the subject. */
Subject.prototype.describe = function () {
  return this.name ? this.name : this.format(this.value, { clip: 128 }) + '';
};

/** Generic failure method that takes a messasge.
    @param {string} msg The failure message.
    @protected
*/
Subject.prototype.fail = function (msg) {
  this.failureStrategy.fail(this.failureMessage || msg);
};

/** Failure method for simple comparison assertions.
    @param {*} expected The expected value, which is different from the actual value.
    @protected
*/
Subject.prototype.failEqual = function (expected) {
  if (this.name) {
    this.fail(
      'Expected ' + this.name + ' to be ' + expected + ', actual value was ' +
        this.format(this.value, { clip: 128 }) + '.');
  } else {
    this.fail(
      'Expected ' + this.describe() + ' to be ' + expected + '.');
  }
};

/** Failure method for simple negated comparison assertions.
    @param {*} expected The expected value, which is the same as the actual value.
    @protected
*/
Subject.prototype.failNotEqual = function (expected) {
  this.fail(
    'Expected ' + this.describe() + ' to not be ' + expected + '.');
};

/** Failure method for simple comparison assertions.
    @param {string} verb The name of the comparison verb, such has 'greater than'.
    @param {*} expected The value that we're comparing against.
    @protected
*/
Subject.prototype.failComparison = function (verb, expected) {
  if (this.name) {
    this.fail(
      'Expected ' + this.name + ' to be ' + verb + ' ' + expected +
        ', actual value was ' + this.format(this.value) + '.');
  } else {
    this.fail(
      'Expected ' + this.describe() + ' to be ' + verb + ' ' + expected + '.');
  }
};

/** Assign a descriptive name to the subject.
    @param {string} name The name to assign to this subject.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.named = function (name) {
  this.name = name;
  return this;
};

/** Override the normal failure message.
    @param {string} msg The failure message to use on failure.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.withFailureMessage = function (msg) {
  this.failureMessage = msg;
  return this;
};

/** Ensure that the subject value is `true`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isTrue = function () {
  if (this.value !== true) {
    this.failEqual('true');
  }
  return this;
};

/** Ensure that the subject value is `false`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isFalse = function () {
  if (this.value !== false) {
    this.failEqual('false');
  }
  return this;
};

/** Ensure that the subject value is true when coerced to a boolean.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isTruthy = function () {
  if (!this.value) {
    this.failEqual('truthy');
  }
  return this;
};

/** Ensure that the subject value is false when coerced to a boolean.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isFalsey = function () {
  if (this.value) {
    this.failEqual('falsey');
  }
  return this;
};

/** Ensure that the subject value is `null`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNull = function () {
  if (this.value !== null) {
    this.failEqual('null');
  }
  return this;
};

/** Ensure that the subject value is not `null`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotNull = function () {
  if (this.value === null) {
    this.failNotEqual('null');
  }
  return this;
};

/** Ensure that the subject value is `undefined`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isUndefined = function () {
  if (this.value !== undefined) {
    this.failEqual('undefined');
  }
  return this;
};

/** Ensure that the subject value is not `undefined`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotUndefined = function () {
  if (this.value === undefined) {
    this.failNotEqual('undefined');
  }
  return this;
};

/** Ensure that the subject value is `null` or `undefined`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNullOrUndefined = function () {
  if (this.value !== null &amp;&amp; this.value !== undefined) {
    this.failEqual('null or undefined');
  }
  return this;
};

/** Ensure that the subject value is not `null` or `undefined`.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotNullOrUndefined = function () {
  if (this.value === null || this.value === undefined) {
    this.failNotEqual('null or undefined');
  }
  return this;
};

/** Synonym for isNotNullOrUndefined.
    @function
    @return {Subject} `this` for chaining.
*/
Subject.prototype.exists = Subject.prototype.isNotNullOrUndefined;

/** Ensure that the value is equal to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isEqualTo = function (expected) {
  if (!(this.value == expected)) {
    var d = diff(expected, this.value, this.name, false);
    this.fail(d.join('\n'));
  }
  return this;
};

/** Synonym for isEqualTo().
    @function
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.equals = Subject.prototype.isEqualTo;

/** Ensure that the subject value is not equal to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotEqualTo = function (expected) {
  if (!(this.value != expected)) {
    this.failNotEqual(this.format(expected));
  }
  return this;
};

/** Ensure that the subject value is exactly equal (===) to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isExactly = function (expected) {
  if (!(this.value === expected)) {
    this.failComparison('exactly', this.format(expected));
  }
  return this;
};

/** Ensure that the subject value is equal to the expected value using a deep comparison.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isDeeplyEqualTo = function (expected) {
  var d = diff(expected, this.value, this.name, true);
  if (d.length > 0) {
    if (d.length > 4) {
      // If there are more than 4 differences, just display the first 4.
      var msg = '...' + d.length - 4 + ' additional differences not shown.';
      d = d.slice(0, 4);
      d.push(msg);
    }
    this.fail(d.join('\n'));
  }
  return this;
};

/** Ensure that the subject value is equal to the expected value using a deep comparison. */
Subject.prototype.isNotDeeplyEqualTo = function (expected) {
  if (compare(expected, this.value, this.name, true)) {
    this.fail(
      'Expected ' + this.describe() + ' to not be deeply equal to ' + expected + '.');
  }
  return this;
}

/** Ensure that the subject value is greater than to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isGreaterThan = function (expected) {
  if (!(this.value > expected)) {
    this.failComparison('greater than', this.format(expected));
  }
  return this;
};

/** Ensure that the subject value is not greater than to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotGreaterThan = function (expected) {
  if (this.value > expected) {
    this.failComparison('not greater than', this.format(expected));
  }
  return this;
};

/** Ensure that the subject value is less than to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isLessThan = function (expected) {
  if (!(this.value &lt; expected)) {
    this.failComparison('less than', this.format(expected));
  }
  return this;
};

/** Ensure that the subject value is not less than to the expected value.
    @param {*} expected The expected value.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotLessThan = function (expected) {
  if (this.value &lt; expected) {
    this.failComparison('not less than', this.format(expected));
  }
  return this;
};

/** Ensure that the subject value is an instance of the expected type.
    @param {Type} expected The expected type.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isInstanceOf = function (expected) {
  if (!(this.value instanceof expected)) {
    var value = this.value;
    if (typeof value !== 'object') {
      // Convert primitive to wrapper object
      value = ({}).valueOf.call(value);
    }
    this.fail(
      'Expected ' + this.describe() + ' to be instance of ' + expected.name +
        ', actual prototype was ' + Object.getPrototypeOf(value).constructor.name + '.');
  }
  return this;
};

/** Ensure that the subject value is not an instance of the expected type.
    @param {Type} expected The expected type.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isNotInstanceOf = function (expected) {
  if (this.value instanceof expected) {
    this.fail(
      'Expected ' + this.describe() + ' to not be instance of ' + expected.name + '.');
  }
  return this;
};

/** Ensure that the subject value has the expected type.
    @param {string} expected The name of the expected type.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.hasType = function (expected) {
  var ty = typeof(this.value);
  if (ty !== expected) {
    this.fail(
      'Expected ' + this.describe() + ' to have type ' + this.format(expected) +
        ', actual type was "' + ty + '".');
  }
  return this;
};

/** Ensure that the subject is in the specified collection.
    @param {Collection} collection An array or set containing matchable elements.
    @return {Subject} `this` for chaining.
*/
Subject.prototype.isIn = function (collection) {
  /* global Set */
  if (Array.isArray(collection)) {
    if (collection.indexOf(this.value) >= 0) {
      return this;
    }
  } else if (typeof Set !== 'undefined' &amp;&amp; collection instanceof Set) {
    if (collection.has(this.value)) {
      return this;
    }
  }
  this.fail(
    'Expected ' + this.describe() + ' to be in ' + this.format(collection) + '.');
  return this;
};

module.exports = Subject;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Jun 02 2017 20:24:03 GMT-0700 (PDT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
